<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no" name="viewport">
    <title>登录 &mdash; PCAT</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.8.2/css/all.min.css">
    <link rel="stylesheet" href="/css/style.css">

</head>

<body>

<div id="app">
    <section class="section">
        <div class="d-flex flex-wrap align-items-stretch">
            <div class="col-lg-4 col-md-6 col-12 order-lg-1 min-vh-100 order-2 bg-white">
                <div class="p-4 m-3">
                    <img src="https://s3.bmp.ovh/imgs/2022/03/8fc8de71a310c31d.png" alt="logo" width="80"
                         class="shadow-light rounded-circle mb-5 mt-2">
                    <h4 class="text-dark font-weight-normal">欢迎访问 <span class="font-weight-bold">STUDY . PCAT</span>
                    </h4>
                    <p class="text-muted">这是一句好听顺嘴而且不长不短刚刚好的标语<br>甚至可以写第二行</p>

                    <form action="javascript:void(0);" method="POST" class="needs-validation layui-form" novalidate="">

                        <div class="login-form-item">
                            <div class="form-group">
                                <label for="email">手机号</label>
                                <input id="email" type="email" class="form-control" name="phone" tabindex="1" required
                                       autofocus>
                                <div class="invalid-feedback">
                                    请填写手机号
                                </div>
                            </div>

                            <div class="form-group">
                                <div class="d-block">
                                    <label for="password" class="control-label">密码</label>
                                </div>
                                <input id="password" type="password" class="form-control" name="password" tabindex="2"
                                       required>
                                <div class="invalid-feedback">
                                    请填写密码
                                </div>
                            </div>
                        </div>

                        <div id="2fa-form" class="form-group" style="display: none;">
                            <label for="2fa-code">二步验证</label>
                            <input id="2fa-code" type="number" class="form-control" name="2fa-code" tabindex="1"
                                   maxlength="6" placeholder="请输入6位验证码" required>
                            <div class="invalid-feedback">
                                请输入验证码
                            </div>
                        </div>

                        <div class="form-group login-form-item">
                            <div class="custom-control custom-checkbox">
                                <input type="checkbox" name="remember" class="custom-control-input" tabindex="3"
                                       id="remember-me">
                                <label class="custom-control-label" for="remember-me">记住我</label>
                            </div>
                        </div>

                        <div class="form-group text-right">
                            <a href="##" id="telegram-login-button" data-toggle="modal" data-target="#telegram-modal"
                               class="float-left mt-3 login-form-item">

                            </a>
                            <button style="width:100px" type="submit" lay-submit="" lay-filter="login"
                                    class="btn btn-primary btn-lg btn-icon icon-right login" tabindex="5">
                                登录
                            </button>
                        </div>
                    </form>

                    <!--                    <div class="mt-5 text-center login-form-item">-->
                    <!--                        还没有账号？<a href="/auth/register">马上注册 👉</a>-->
                    <!--                    </div>-->

                    <div class="text-center mt-10 " style="font-size: 12px;margin-top: 110px">
                        Copyright &copy; 2022 PCAT

                    </div>
                    <div class="text-center" style="font-size: 12px;font-weight: 10;color: #6c757d;">
                        Power By PC

                    </div>

                </div>
            </div>
            <div class="col-lg-8 col-12 order-lg-2 order-1 min-vh-100 background-walk-y position-relative overlay-gradient-bottom"
                 data-background="https://s3.bmp.ovh/imgs/2022/03/a6098b4c5094fe66.jpg"
                 style='background-image: url("https://s3.bmp.ovh/imgs/2022/03/a6098b4c5094fe66.jpg");'>
                <div class="absolute-bottom-left index-2">
                    <div class="text-light p-5 pb-2">
                        <div class="mb-5 pb-3">
                            <h1 class="mb-2 display-4 font-weight-bold">Good Morning</h1>
                            <h5 class="font-weight-normal text-muted-transparent">Bali, Indonesia</h5>
                        </div>
                        Photo by <a class="text-light" target="_blank" href="https://unsplash.com/photos/a8lTjWJJgLA">Justin
                        Kauffman</a> on <a class="text-light" target="_blank" href="https://unsplash.com">Unsplash</a>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

<script src="https://www.layuicdn.com/layui-v2.5.6/layui.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.4/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/tooltip.js@1.3.2/dist/umd/tooltip.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.nicescroll@3.7.6/jquery.nicescroll.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.18.1/min/moment.min.js"></script>
<script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@7.25.6/dist/sweetalert2.all.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>

<script th:inline="javascript">
    layui.use(['form'], function () {
        var form = layui.form,
            layer = layui.layer;
        // 进行登录操作
        form.on('submit(login)', function (data) {

            data = data.field;
            if (data.phone === '') {
                layer.msg('用户名不能为空', {
                    icon: 5,
                    offset: '15px'
                });
                return false;
            }
            if (data.password === '') {
                layer.msg('密码不能为空', {
                    icon: 5,
                    offset: '15px'
                });
                return false;
            }

            alert('/users/'+data.phone+'/'+data.password);
            $.ajax({
                type: 'GET',
                url: '/users/'+data.phone+'/'+data.password,
                beforeSend: function () {
                    layer.msg('登陆中，请稍后...', {
                        icon: 16
                        , shade: 0.01
                    });
                },
                success: function (data) {
                    layer.closeAll();
                    let json;
                    if ((typeof data === 'string') && data.constructor === String) {
                        if (data.charAt(0) === '<') {
                            layer.msg('服务器异常,请稍后重试!', {
                                icon: 5,
                                offset: '15px'
                            });
                            return;
                        }
                        json = JSON.parse(data);
                    } else {
                        json = data;
                    }
                    if (json.status === 400) {
                        let msg = json.message;
                        layer.msg(msg, {
                            icon: 5,
                            offset: '15px'
                        });
                        //changeCodePic();
                        //$('.layui-btn.layui-btn-fluid').removeClass('layui-btn-disabled');
                    } else if (json.status === 200) {
                        layer.msg('登录成功', {
                            icon: 6,
                            offset: '15px',
                            time: 1000
                        }, function () {
                            location.href = '/pages/subject';
                        })
                    }
                },
                error: function () {
                    layer.msg('登录失败，请检查网络后重新尝试!');
                    //changeCodePic();
                }
            });
        });
    });
</script>

</body>

</html>